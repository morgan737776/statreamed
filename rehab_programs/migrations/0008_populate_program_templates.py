# Generated by Django 5.2.3 on 2025-06-19 09:13

# -*- coding: utf-8 -*-
from django.db import migrations


# Словарь с данными для шаблонов программ
TEMPLATES_DATA = {
    "Реабилитация после ишемического инсульта": {
        "description": "Комплексная программа для восстановления функций после ишемического инсульта. Ранний этап.",
        "program_type": "INPATIENT",
        "activities": [
            'Первичная консультация врача-реабилитолога',
            'Консультация невролога',
            'Индивидуальное занятие ЛФК с инструктором',
            'Механотерапия на тренажере \"Artromot\"',
            'Бобат-терапия',
            'Медицинский массаж, 1.5 ед (15 мин)',
            'Нейропсихологическая диагностика',
            'Логопедическое занятие по восстановлению речи (афазия, дизартрия)',
            'Индивидуальное занятие с эрготерапевтом',
            'Занятие по восстановлению функции глотания',
        ]
    },
    "Реабилитация после эндопротезирования тазобедренного сустава": {
        "description": "Программа для восстановления амплитуды движений и укрепления мышц после замены тазобедренного сустава.",
        "program_type": "INPATIENT",
        "activities": [
            'Первичная консультация врача-реабилитолога',
            'Консультация травматолога-ортопеда',
            'Индивидуальное занятие ЛФК с инструктором',
            'Механотерапия на тренажере \"Artromot\"',
            'Прессотерапия (аппаратный лимфодренаж)',
            'Медицинский массаж, 1.5 ед (15 мин)',
            'Обучение пользованию ТСР (техническими средствами реабилитации)',
        ]
    },
    "Кардиореабилитация (после инфаркта миокарда)": {
        "description": "Программа для восстановления сердечно-сосудистой системы и повышения толерантности к физическим нагрузкам.",
        "program_type": "OUTPATIENT",
        "activities": [
            'Консультация кардиолога с ЭКГ',
            'Групповое занятие ЛФК',
            'Дыхательная гимнастика (по Стрельниковой, Бутейко)',
            'Консультация медицинского психолога (психодиагностика)',
            'Диетотерапия (разработка индивидуального меню)',
        ]
    },
    "Реабилитация при болях в спине (консервативное лечение)": {
        "description": "Программа для снятия болевого синдрома, укрепления мышечного корсета и профилактики обострений.",
        "program_type": "OUTPATIENT",
        "activities": [
            'Консультация невролога',
            'Индивидуальное занятие ЛФК с инструктором',
            'Терапия на подвесных системах (Экзарта, Redcord)',
            'Магнитотерапия (общая/локальная)',
            'Мануальная терапия',
            'Иглорефлексотерапия',
        ]
    },
    "Реабилитация после эндопротезирования коленного сустава": {
        "description": "Программа для восстановления функции коленного сустава, увеличения амплитуды движений и укрепления мышц.",
        "program_type": "INPATIENT",
        "activities": [
            'Консультация травматолога-ортопеда',
            'Индивидуальное занятие ЛФК с инструктором',
            'Механотерапия на тренажере \"Artromot\"',
            'Криотерапия локальная',
            'Магнитотерапия (общая/локальная)',
            'Лимфодренажный массаж ручной',
            'Обучение пользованию ТСР (техническими средствами реабилитации)',
        ]
    },
    "Реабилитация после травмы позвоночника (поздний этап)": {
        "description": "Программа направлена на социальную адаптацию, улучшение мобильности и профилактику осложнений.",
        "program_type": "INPATIENT",
        "activities": [
            'Консультация невролога',
            'Индивидуальное занятие ЛФК с инструктором',
            'Роботизированная механотерапия (Lokomat, Armeo)',
            'Гидрокинезотерапия в бассейне (индивидуально)',
            'Индивидуальное занятие с эрготерапевтом',
            'Консультация медицинского психолога (психодиагностика)',
            'Обучение пользованию ТСР (техническими средствами реабилитации)',
        ]
    },
    "Реабилитация после COVID-19 (постковидный синдром)": {
        "description": "Комплексная программа для восстановления дыхательной и сердечно-сосудистой систем, а также когнитивных функций.",
        "program_type": "OUTPATIENT",
        "activities": [
            'Консультация врача-реабилитолога',
            'Спирометрия (оценка функции внешнего дыхания)',
            'Дыхательная гимнастика (по Стрельниковой, Бутейко)',
            'Групповое занятие ЛФК',
            'Индивидуальная психотерапия',
            'Общий массаж (60 мин)',
        ]
    },
    "Реабилитация при детском церебральном параличе (ДЦП)": {
        "description": "Программа для развития двигательных навыков, улучшения координации и социальной адаптации ребенка.",
        "program_type": "INPATIENT",
        "activities": [
            'Консультация невролога',
            'Бобат-терапия',
            'Войта-терапия',
            'Логопедическое занятие по восстановлению речи (афазия, дизартрия)',
            'Индивидуальное занятие с эрготерапевтом',
            'Гидрокинезотерапия в бассейне (индивидуально)',
            'Арт-терапия',
        ]
    },
    "Онкореабилитация (после мастэктомии)": {
        "description": "Программа для профилактики лимфостаза, восстановления подвижности плечевого сустава и психологической поддержки.",
        "program_type": "OUTPATIENT",
        "activities": [
            'Консультация врача ЛФК',
            'Индивидуальное занятие ЛФК с инструктором',
            'Прессотерапия (аппаратный лимфодренаж)',
            'Лимфодренажный массаж ручной',
            'Семейное психологическое консультирование',
        ]
    },
    "Реабилитация после ампутации нижней конечности (подготовка к протезированию)": {
        "description": "Комплексная программа для подготовки к протезированию, включая формирование культи, фантомно-болевой синдром и обучение ходьбе.",
        "program_type": "INPATIENT",
        "activities": [
            'Консультация травматолога-ортопеда',
            'Индивидуальное занятие ЛФК с инструктором',
            'Медицинский массаж, 1.5 ед (15 мин)',
            'Зеркальная терапия (при фантомных болях)',
            'Обучение пользованию ТСР (техническими средствами реабилитации)',
            'Тренировка ходьбы с протезом',
            'Консультация медицинского психолога (психодиагностика)',
        ]
    },
    "Психологическая реабилитация при ПТСР": {
        "description": "Программа, направленная на снижение симптомов посттравматического стрессового расстройства и восстановление психоэмоционального состояния.",
        "program_type": "OUTPATIENT",
        "activities": [
            'Консультация медицинского психолога (психодиагностика)',
            'Индивидуальная психотерапия',
            'Когнитивно-поведенческая терапия (КПТ)',
            'Групповая психотерапия',
            'Арт-терапия',
        ]
    },
    "Восстановление после политравмы (ДТП)": {
        "description": "Комплексная междисциплинарная программа для пациентов с множественными травмами.",
        "program_type": "INPATIENT",
        "activities": [
            'Первичная консультация врача-реабилитолога',
            'Консультация невролога',
            'Консультация травматолога-ортопеда',
            'Индивидуальное занятие ЛФК с инструктором',
            'Бобат-терапия',
            'Мануальная терапия',
            'Индивидуальное занятие с эрготерапевтом',
            'Индивидуальная психотерапия',
        ]
    },
    "Реабилитация при болезни Паркинсона": {
        "description": "Программа для поддержания двигательной активности, улучшения координации и баланса.",
        "program_type": "OUTPATIENT",
        "activities": [
            'Консультация невролога',
            'Индивидуальное занятие ЛФК с инструктором',
            'Занятие на стабилометрической платформе с БОС',
            'Логопедическое занятие по восстановлению речи (афазия, дизартрия)',
            'Тренировка бытовых навыков (ADL)',
        ]
    },
    "Восстановление после операции аортокоронарного шунтирования (АКШ)": {
        "description": "Кардиореабилитация, направленная на восстановление после операции на сердце.",
        "program_type": "INPATIENT",
        "activities": [
            'Консультация кардиолога с ЭКГ',
            'Дыхательная гимнастика (по Стрельниковой, Бутейко)',
            'Групповое занятие ЛФК',
            'Диетотерапия (разработка индивидуального меню)',
            'Консультация медицинского психолога (психодиагностика)',
        ]
    }
}

def populate_templates(apps, schema_editor):
    RehabProgramTemplate = apps.get_model('rehab_programs', 'RehabProgramTemplate')
    RehabActivity = apps.get_model('rehab_programs', 'RehabActivity')
    db_alias = schema_editor.connection.alias

    for template_name, data in TEMPLATES_DATA.items():
        template, created = RehabProgramTemplate.objects.using(db_alias).get_or_create(
            name=template_name,
            defaults={
                'description': data['description'],
                'program_type': data['program_type']
            }
        )
        if created:
            activities_to_add = RehabActivity.objects.using(db_alias).filter(name__in=data['activities'])
            template.activities.set(activities_to_add)

def unpopulate_templates(apps, schema_editor):
    RehabProgramTemplate = apps.get_model('rehab_programs', 'RehabProgramTemplate')
    db_alias = schema_editor.connection.alias
    RehabProgramTemplate.objects.using(db_alias).filter(name__in=TEMPLATES_DATA.keys()).delete()




class Migration(migrations.Migration):

    dependencies = [
        ('rehab_programs', '0007_rehabprogramtemplate'),
    ]

    operations = [
        migrations.RunPython(populate_templates, reverse_code=unpopulate_templates),
    ]
